))) %>%
group_by(value_dim, crypto_posession) %>%
mutate(value_median = median(value_score)) %>%
ggplot(aes(value_score, color = crypto_posession), stat = "unique")+
facet_grid(rows = vars(value_dim), switch = "both")+
geom_vline(xintercept = 0)+
geom_density(size = 1.5)+
geom_vline(aes(xintercept = value_median, color = crypto_posession),
size = 1)+
theme_minimal(base_size = 16)+
scale_x_continuous(limits = c(-3, 3), breaks = c(-3: 3), minor_breaks = NULL)+
xlab("Value Score (z)")+
labs(
title = "Density plot: Value dimensions",
caption = "Values are z-standardized; Horizontal line is the median"
)+
theme(
legend.position = "bottom",
axis.text.y = element_blank(),
axis.title.y = element_blank(),
strip.text.y.left = element_text(angle = 0, hjust = 1),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()
)
sample
# --- Descriptive stats
# --- packages import
if (!require(rstatix)) {
install.packages("rstatix")
require(rstatix)
}
if (!require(Hmisc)) {
install.packages("Hmisc")
require(Hmisc)
}
if (!require(corrplot)) {
install.packages("corrplot")
require(corrplot)
}
if (!require(psych)) {
install.packages("psych")
require(psych)
}
library(rstatix)
library(Hmisc)
library(corrplot)
library(psych)
# --- data import
load("data/df.Rdata")
# --- extra functions
source("scripts/helper_functions.R")
sample<-df_ipst %>%
dplyr::select(sex,edu,employ) %>%
naturalize_labelled_df() %>%
pivot_longer(cols=c(sex_fct,
edu_fct,
employ_fct)) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate( total_n=sum(n),
prop=100*n/sum(n),
cum=100*cumsum(prop/sum(prop))) %>%
ungroup()
sample
sample<-df_ipst %>%
dplyr::select(sex,edu,employ) %>%
naturalize_labelled_df() %>%
pivot_longer(cols=c(sex_fct,
edu_fct,
employ_fct)) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate( total_n=sum(n),
prop=100*n/sum(n),
cum=100*cumsum(prop/sum(prop))) %>%
ungroup()
df_ipst
if (!require(rstatix)) {
install.packages("rstatix")
require(rstatix)
}
if (!require(Hmisc)) {
install.packages("Hmisc")
require(Hmisc)
}
if (!require(corrplot)) {
install.packages("corrplot")
require(corrplot)
}
if (!require(psych)) {
install.packages("psych")
require(psych)
}
library(rstatix)
library(Hmisc)
library(corrplot)
library(psych)
# --- data import
load("data/df.Rdata")
names(df_ipst)
list_krypto_gradient <- list("krybws01","krybst01","krybsz01","kryvst01")
list_krypto_gradient
list_krypto_gradient <- list("krybws01","krybst01","krybsz01")
proba<- df_ipst %>% select(krybws01)
proba
proba<- df_ipst %>% dplyr::select(list_krypto_gradient) %>% pivot_longer() %>% group_by(name,value) %>% summarise(n=n()) %>% mutate(total_n=sum(n),prop=100*n/total_n,cum=100*cumsum(prop/sum(prop)))
proba<- df_ipst %>% dplyr::select(krybws01,krybst01,krybsz01) %>% pivot_longer() %>% group_by(name,value) %>% summarise(n=n()) %>% mutate(total_n=sum(n),prop=100*n/total_n,cum=100*cumsum(prop/sum(prop)))
proba<- df_ipst %>% dplyr::select(krybws01,krybst01,krybsz01) %>% pivot_longer(ever) %>% group_by(name,value) %>% summarise(n=n()) %>% mutate(total_n=sum(n),prop=100*n/total_n,cum=100*cumsum(prop/sum(prop)))
proba<- df_ipst %>% dplyr::select(krybws01,krybst01,krybsz01) %>% pivot_longer(everything()) %>% group_by(name,value) %>% summarise(n=n()) %>% mutate(total_n=sum(n),prop=100*n/total_n,cum=100*cumsum(prop/sum(prop)))
proba
proba<- df_ipst %>% dplyr::select(krybws01,krybst01,krybsz01) %>% pivot_longer(everything()) %>% group_by(name,value) %>% summarise(n=n()) %>% mutate(total_n=sum(n),prop=100*n/total_n,cum=100*cumsum(prop/sum(prop)))
gradient_descriptive <- df_ipst %>%
sjlabelled::zap_labels() %>%
dplyr::select(krybws01,krybst01,krybsz01) %>%
pivot_longer(everything()) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate(total_n=sum(n),
prop=100*n/total_n,
cum=100*cumsum(prop/sum(prop)))
gradient_descriptive
warnings()
summary(df_ipst$krybws01)
summary(df_ipst$krybst01)
gradient_descriptive <- df_ipst %>%
sjlabelled::zap_labels() %>%
dplyr::select(krybws01) %>%
pivot_longer(everything()) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate(total_n=sum(n),
prop=100*n/total_n,
cum=100*cumsum(prop/sum(prop)))
gradient_descriptive
gradient_descriptive <- df_ipst %>%
dplyr::select(krybws01) %>%
pivot_longer(everything()) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate(total_n=sum(n),
prop=100*n/total_n,
cum=100*cumsum(prop/sum(prop)))
gradient_descriptive
gradient_heardof <- df_ipst %>%
dplyr::select(krybws01) %>%
pivot_longer(everything()) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate(total_n=sum(n),
prop=100*n/total_n,
cum=100*cumsum(prop/sum(prop)))
gradient_holds <- df_ipst %>%
filter(krybws01==1) %>%
dplyr::select(krybst01) %>%
pivot_longer(everything()) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate(total_n=sum(n),
prop=100*n/total_n,
cum=100*cumsum(prop/sum(prop)))
gradient_holds
gradient_futurehold <- df_ipst %>%
filter(krybws01==1) %>%
dplyr::select(krybsz01) %>%
pivot_longer(everything()) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate(total_n=sum(n),
prop=100*n/total_n,
cum=100*cumsum(prop/sum(prop)))
gradient_futurehold
gradient_futurehold_holdsnot <- df_ipst %>%
filter(krybws01==1) %>%
dplyr::select(krybsz01==3) %>%
pivot_longer(everything()) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate(total_n=sum(n),
prop=100*n/total_n,
cum=100*cumsum(prop/sum(prop)))
gradient_futurehold_heardof <- df_ipst %>%
filter(krybws01==1) %>%
dplyr::select(krybsz01) %>%
pivot_longer(everything()) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate(total_n=sum(n),
prop=100*n/total_n,
cum=100*cumsum(prop/sum(prop)))
gradient_futurehold_heardof
gradient_futurehold_holdsnot <- df_ipst %>%
filter(krybws01==1 | krybst01==3) %>%
dplyr::select(krybsz01) %>%
pivot_longer(everything()) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate(total_n=sum(n),
prop=100*n/total_n,
cum=100*cumsum(prop/sum(prop)))
gradient_futurehold_holdsnot
gradient_futurehold_holdsnot <- df_ipst %>%
filter(krybws01==1 & krybst01==3) %>%
dplyr::select(krybsz01) %>%
pivot_longer(everything()) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate(total_n=sum(n),
prop=100*n/total_n,
cum=100*cumsum(prop/sum(prop)))
gradient_futurehold_holdsnot
gradient_heardof
gradient_heardof[1,2]
gradient_heardof[2,2]
gradient_heardof[3,2]
gradient_heardof[4,2]
gradient_heardof[3,2]
gradient_heardof[3,4]
gradient_heardof[1,4]
gradient_heardof[1,5]
gradient_descriptive <- tibble(
Dimension = c("Awareness"),
"N Dimension" = c(gradient_heardof[1,4]),
Case = c("Heard of crypto"),
"% Case" = c(gradient_heardof[1,5])
)
gradient_descriptive
gradient_descriptive <- tibble(
Dimension = c("Awareness"),
"N Dimension" = c(as.numeric(gradient_heardof[1,4])),
Case = c("Heard of crypto"),
"% Case" = c(gradient_heardof[1,5])
)
gradient_descriptive
n_dim_awareness = gradient_heardof[1,4] %>% as.numeric()
prop_heardof = gradient_heardof[1,5] %>% as.numeric()
# table gradient awareness - current hold - holds in the future
gradient_descriptive <- tibble(
Dimension = c("Awareness"),
"N Dimension" = c(n_dim_awareness),
Case = c("Heard of crypto"),
"% Case" = c(prop_heardof)
)
gradient_descriptive
gradient_holds
# ready to fill in table below
n_dim_awareness = gradient_heardof[1,4] %>% as.numeric()
n_dim_holds = gradient_holds[1,4] %>% as.numeric()
prop_heardof = gradient_heardof[1,5] %>% as.numeric()
prop_holdsnow = gradient_holds[1,5] %>% as.numeric()
prop_holdspast = gradient_past[2,5] %>% as.numeric()
# table gradient awareness - current hold - holds in the future
gradient_descriptive <- tibble(
Dimension = c("Awareness","Holding behavior",""),
"N Dimension" = c(n_dim_awareness,n_dim_holds,""),
Case = c("Heard of crypto","Currently holds","Held in the past"),
"% Case" = c(prop_heardof,prop_holdsnow,prop_holdspast)
)
# ready to fill in table below
n_dim_awareness = gradient_heardof[1,4] %>% as.numeric()
n_dim_holds = gradient_holds[1,4] %>% as.numeric()
prop_heardof = gradient_heardof[1,5] %>% as.numeric()
prop_holdsnow = gradient_holds[1,5] %>% as.numeric()
prop_holdspast = gradient_holds[2,5] %>% as.numeric()
# table gradient awareness - current hold - holds in the future
gradient_descriptive <- tibble(
Dimension = c("Awareness","Holding behavior",""),
"N Dimension" = c(n_dim_awareness,n_dim_holds,""),
Case = c("Heard of crypto","Currently holds","Held in the past"),
"% Case" = c(prop_heardof,prop_holdsnow,prop_holdspast)
)
gradient_descriptive
gradient_descriptive <- tibble(
Dimension = c("Awareness","Holding behavior",""),
"N Dimension" = c(n_dim_awareness,n_dim_holds,""),
Case = c("Heard of crypto","Currently holds","Held in the past"),
"% of N Dimension" = c(prop_heardof,prop_holdsnow,prop_holdspast)
)
gradient_descriptive
gradient_futurehold_heardof
# --- ready to fill in table below
n_dim_awareness = gradient_heardof[1,4] %>% as.numeric()
n_dim_holds = gradient_holds[1,4] %>% as.numeric()
n_dim_future_aware = gradient_futurehold_heardof[1,4] %>% as.numeric()
# awareness
prop_heardof = gradient_heardof[1,5] %>% as.numeric()
# holding behavior
prop_holdsnow = gradient_holds[1,5] %>% as.numeric()
prop_holdspast = gradient_holds[2,5] %>% as.numeric()
# intention behavior among those with awareness
prop_future_aware_yes = gradient_futurehold_heardof[1,5] %>% as.numeric()
prop_future_aware_no = gradient_futurehold_heardof[2,5] %>% as.numeric()
prop_future_aware_unclear = gradient_futurehold_heardof[3,5] %>% as.numeric()
prop_future_aware_na = gradient_futurehold_heardof[4,5] %>% as.numeric()
# ---- table gradient awareness - current hold - holds in the future
gradient_descriptive <- tibble(
Dimension = c("Awareness",
"Holding behavior currently","",
"Holding intention future among those with awareness","",""),
"N Dimension" = c(n_dim_awareness,
n_dim_holds,"",
n_dim_future_aware,"",""),
Case = c("Heard of crypto",
"Currently holds","Held in the past",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing"),
"% of N Dimension" = c(prop_heardof,
prop_holdsnow,prop_holdspast,
prop_future_aware_yes,prop_future_aware_no,prop_future_aware_unclear,prop_future_aware_na)
)
gradient_descriptive <- tibble(
Dimension = c("Awareness",
"Holding behavior currently","",
"Holding intention future among those with awareness","","",""),
"N Dimension" = c(n_dim_awareness,
n_dim_holds,"",
n_dim_future_aware,"",""),
Case = c("Heard of crypto",
"Currently holds","Held in the past",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing"),
"% of N Dimension" = c(prop_heardof,
prop_holdsnow,prop_holdspast,
prop_future_aware_yes,prop_future_aware_no,prop_future_aware_unclear,prop_future_aware_na)
)
gradient_descriptive <- tibble(
Dimension = c("Awareness",
"Holding behavior currently","",
"Holding intention future among those with awareness","","",""),
"N Dimension" = c(n_dim_awareness,
n_dim_holds,"",
n_dim_future_aware,"","",""),
Case = c("Heard of crypto",
"Currently holds","Held in the past",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing"),
"% of N Dimension" = c(prop_heardof,
prop_holdsnow,prop_holdspast,
prop_future_aware_yes,prop_future_aware_no,prop_future_aware_unclear,prop_future_aware_na)
)
gradient_descriptive
gradient_futurehold_holdsnot
# --- ready to fill in table below
n_dim_awareness = gradient_heardof[1,4] %>% as.numeric()
n_dim_holds = gradient_holds[1,4] %>% as.numeric()
n_dim_future_aware = gradient_futurehold_heardof[1,4] %>% as.numeric()
n_dim_future_holdsnownot = gradient_futurehold_holdsnot[1,4] %>% as.numeric
# awareness
prop_heardof = gradient_heardof[1,5] %>% as.numeric()
# holding behavior
prop_holdsnow = gradient_holds[1,5] %>% as.numeric()
prop_holdspast = gradient_holds[2,5] %>% as.numeric()
prop_holdsnot = gradient_holds[3,5] %>% as.numeric()
# intention behavior among those with awareness
prop_future_aware_yes = gradient_futurehold_heardof[1,5] %>% as.numeric()
prop_future_aware_no = gradient_futurehold_heardof[2,5] %>% as.numeric()
prop_future_aware_unclear = gradient_futurehold_heardof[3,5] %>% as.numeric()
prop_future_aware_na = gradient_futurehold_heardof[4,5] %>% as.numeric()
# intention behavior among those who never held but heard of
prop_future_neverheld_yesfuture = gradient_futurehold_holdsnot[1,5] %>% as.numeric()
prop_future_neverheld_nofuture = gradient_futurehold_holdsnot[2,5] %>% as.numeric()
prop_future_neverheld_unclearfuture = gradient_futurehold_holdsnot[3,5] %>% as.numeric()
prop_future_neverheld_nafuture = gradient_futurehold_holdsnot[4,5] %>% as.numeric()
# ---- table gradient awareness - current hold - holds in the future
gradient_descriptive <- tibble(
Dimension = c("Awareness",
"Holding behavior currently","","",
"Holding intention future among those with awareness","","","",
"Holding intention future among those with awareness but never held","","",""),
"N Dimension" = c(n_dim_awareness,
n_dim_holds,"","",
n_dim_future_aware,"","","",
n_dim_future_holdsnownot,"","",""),
Case = c("Heard of crypto",
"Currently holds","Held in the past","Never held",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing"),
"% of N Dimension" = c(prop_heardof,
prop_holdsnow,prop_holdspast,prop_holdsnot,
prop_future_aware_yes,prop_future_aware_no,prop_future_aware_unclear,prop_future_aware_na,
prop_future_neverheld_yesfuture,prop_future_neverheld_nofuture,prop_future_neverheld_unclearfuture,prop_future_neverheld_nafuture)
)
gradient_futurehold_holdsnot
gradient_descriptive
# --- ready to fill in table below
n_dim_awareness = gradient_heardof[1,4] %>% as.numeric()
n_dim_holds = gradient_holds[1,4] %>% as.numeric()
n_dim_future_aware = gradient_futurehold_heardof[1,4] %>% as.numeric()
n_dim_future_holdsnownot = gradient_futurehold_holdsnot[1,4] %>% as.numeric
# awareness
prop_heardofyes = gradient_heardof[1,5] %>% as.numeric()
prop_heardofno = gradient_heardof[2,5] %>% as.numeric()
# holding behavior
prop_holdsnow = gradient_holds[1,5] %>% as.numeric()
prop_holdspast = gradient_holds[2,5] %>% as.numeric()
prop_holdsnot = gradient_holds[3,5] %>% as.numeric()
# intention behavior among those with awareness
prop_future_aware_yes = gradient_futurehold_heardof[1,5] %>% as.numeric()
prop_future_aware_no = gradient_futurehold_heardof[2,5] %>% as.numeric()
prop_future_aware_unclear = gradient_futurehold_heardof[3,5] %>% as.numeric()
prop_future_aware_na = gradient_futurehold_heardof[4,5] %>% as.numeric()
# intention behavior among those who never held but heard of
prop_future_neverheld_yesfuture = gradient_futurehold_holdsnot[1,5] %>% as.numeric()
prop_future_neverheld_nofuture = gradient_futurehold_holdsnot[2,5] %>% as.numeric()
prop_future_neverheld_unclearfuture = gradient_futurehold_holdsnot[3,5] %>% as.numeric()
prop_future_neverheld_nafuture = gradient_futurehold_holdsnot[4,5] %>% as.numeric()
# ---- table gradient awareness - current hold - holds in the future
gradient_descriptive <- tibble(
Dimension = c("Awareness","",
"Holding behavior currently","","",
"Holding intention future among those with awareness","","","",
"Holding intention future among those with awareness but never held","","",""),
"N Dimension" = c(n_dim_awareness,"",
n_dim_holds,"","",
n_dim_future_aware,"","","",
n_dim_future_holdsnownot,"","",""),
Case = c("Heard of crypto","",
"Currently holds","Held in the past","Never held",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing"),
"% of N Dimension" = c(prop_heardofyes,prop_heardofno,
prop_holdsnow,prop_holdspast,prop_holdsnot,
prop_future_aware_yes,prop_future_aware_no,prop_future_aware_unclear,prop_future_aware_na,
prop_future_neverheld_yesfuture,prop_future_neverheld_nofuture,prop_future_neverheld_unclearfuture,prop_future_neverheld_nafuture)
)
gradient_descriptive
# --- ready to fill in table below
n_dim_awareness = gradient_heardof[1,4] %>% as.numeric()
n_dim_holds = gradient_holds[1,4] %>% as.numeric()
n_dim_future_aware = gradient_futurehold_heardof[1,4] %>% as.numeric()
n_dim_future_holdsnownot = gradient_futurehold_holdsnot[1,4] %>% as.numeric
# awareness
prop_heardofyes = gradient_heardof[1,5] %>% as.numeric()
prop_heardofno = gradient_heardof[2,5] %>% as.numeric()
# holding behavior
prop_holdsnow = gradient_holds[1,5] %>% as.numeric()
prop_holdspast = gradient_holds[2,5] %>% as.numeric()
prop_holdsnot = gradient_holds[3,5] %>% as.numeric()
# intention behavior among those with awareness
prop_future_aware_yes = gradient_futurehold_heardof[1,5] %>% as.numeric()
prop_future_aware_no = gradient_futurehold_heardof[2,5] %>% as.numeric()
prop_future_aware_unclear = gradient_futurehold_heardof[3,5] %>% as.numeric()
prop_future_aware_na = gradient_futurehold_heardof[4,5] %>% as.numeric()
# intention behavior among those who never held but heard of
prop_future_neverheld_yesfuture = gradient_futurehold_holdsnot[1,5] %>% as.numeric()
prop_future_neverheld_nofuture = gradient_futurehold_holdsnot[2,5] %>% as.numeric()
prop_future_neverheld_unclearfuture = gradient_futurehold_holdsnot[3,5] %>% as.numeric()
prop_future_neverheld_nafuture = gradient_futurehold_holdsnot[4,5] %>% as.numeric()
# ---- table gradient awareness - current hold - holds in the future
gradient_descriptive <- tibble(
Dimension = c("Awareness","",
"Holding behavior currently","","",
"Holding intention future among those with awareness","","","",
"Holding intention future among those with awareness but never held","","",""),
"N Dimension" = c(n_dim_awareness,"",
n_dim_holds,"","",
n_dim_future_aware,"","","",
n_dim_future_holdsnownot,"","",""),
Case = c("Heard of crypto","Never heard of crypto",
"Currently holds","Held in the past","Never held",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing"),
"% of N Dimension" = c(prop_heardofyes,prop_heardofno,
prop_holdsnow,prop_holdspast,prop_holdsnot,
prop_future_aware_yes,prop_future_aware_no,prop_future_aware_unclear,prop_future_aware_na,
prop_future_neverheld_yesfuture,prop_future_neverheld_nofuture,prop_future_neverheld_unclearfuture,prop_future_neverheld_nafuture)
)
gradient_descriptive
# --- save data
save(list=c("gradient_descriptive"),
file="data/gradient.Rdata")
?kable_styling()
# ---- table gradient awareness - current hold - holds in the future
gradient_descriptive <- tibble(
Dimension = c("Awareness","",
"Holding behavior currently","","",
"Holding intention future among those with awareness","","","",
"Holding intention future among those with awareness but never held","","",""),
N = c(n_dim_awareness,"",
n_dim_holds,"","",
n_dim_future_aware,"","","",
n_dim_future_holdsnownot,"","",""),
Case = c("Heard of crypto","Never heard of crypto",
"Currently holds","Held in the past","Never held",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing"),
"% of N" = c(prop_heardofyes,prop_heardofno,
prop_holdsnow,prop_holdspast,prop_holdsnot,
prop_future_aware_yes,prop_future_aware_no,prop_future_aware_unclear,prop_future_aware_na,
prop_future_neverheld_yesfuture,prop_future_neverheld_nofuture,prop_future_neverheld_unclearfuture,prop_future_neverheld_nafuture)
)
# --- save data
save(list=c("gradient_descriptive"),
file="data/gradient.Rdata")
# ---- table gradient awareness - current hold - holds in the future
gradient_descriptive <- tibble(
Dimension = c("Awareness","",
"Holding behavior currently","","",
"Holding intention future among those with awareness","","","",
"Holding intention future among those with awareness but never held","","",""),
N = c(n_dim_awareness,"",
n_dim_holds,"","",
n_dim_future_aware,"","","",
n_dim_future_holdsnownot,"","",""),
Case = c("Heard of crypto","Never heard of crypto",
"Currently holds","Held in the past","Never held",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing",
"Wants to hold","Doesn't want to hold","Is unsure","Data missing"),
"%" = c(prop_heardofyes,prop_heardofno,
prop_holdsnow,prop_holdspast,prop_holdsnot,
prop_future_aware_yes,prop_future_aware_no,prop_future_aware_unclear,prop_future_aware_na,
prop_future_neverheld_yesfuture,prop_future_neverheld_nofuture,prop_future_neverheld_unclearfuture,prop_future_neverheld_nafuture)
)
# --- save data
save(list=c("gradient_descriptive"),
file="data/gradient.Rdata")
