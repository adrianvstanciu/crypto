pvq_OCH_sdt = c("pvqsd01", "pvqsdt23", "pvqsdt39")
)
pvq_12dim <- list(
pvq12_STR_ben = c("pvqbed19", "pvqbed27", "pvqbed55",
"pvqbec11", "pvqbec25", "pvqbec47"),
pvq12_STR_un = c("pvqunt14", "pvqunt34", "pvqunt57",
"pvqunc05", "pvqunc37", "pvqunc52",
"pvqunc05", "pvqunc37", "pvqunc52"),
pvq12_CON_hum = c("pvqhum07", "pvqhum38", "pvqhum54"),
pvq12_CON_cov = c("pvqcoi04", "pvqcoi22", "pvqcoi51",
"pvqcor15", "pvqcor31", "pvqcor42"),
pvq12_CON_trd = c("pvqtra18", "pvqtra33", "pvqtra40"),
pvq12_CON_sec = c("pvqses02", "pvqses35", "pvqses50",
"pvqsep13", "pvqsep26", "pvqsep53"),
pvq12_CON_fac = c("pvqfac09", "pvqfac24", "pvqfac49"),
pvq12_SEN_pwr = c("pvqpor12", "pvqpor20", "pvqpor44",
"pvqpod06", "pvqpod29", "pvqpod41"),
pvq12_SEN_ach = c("pvqach17", "pvqach32", "pvqach48"),
pvq12_SEN_he = c("pvqhed03", "pvqhed36", "pvqhed46"),
pvq12_OCH_st = c("pvqsti10","pvqsti28", "pvqsti43"),
pvq12_OCH_sdr = c("pvqsda16", "pvqsda30", "pvqsda56",
"pvqsd01", "pvqsdt23", "pvqsdt39")
)
# - list with pvq dim
pvq_STR_bed = c("pvqbed19", "pvqbed27", "pvqbed55")
pvq_STR_bec = c("pvqbec11", "pvqbec25", "pvqbec47")
pvq_STR_unt = c("pvqunt14", "pvqunt34", "pvqunt57")
pvq_STR_unc = c("pvqunc05", "pvqunc37", "pvqunc52")
pvq_STR_unn = c("pvqunn08", "pvqunn21", "pvqunn45")
pvq_STR_hum = c("pvqhum07", "pvqhum38", "pvqhum54")
pvq_CON_coi = c("pvqcoi04", "pvqcoi22", "pvqcoi51")
pvq_CON_cor = c("pvqcor15", "pvqcor31", "pvqcor42")
pvq_CON_tr = c("pvqtra18", "pvqtra33", "pvqtra40")
pvq_CON_ses = c("pvqses02", "pvqses35", "pvqses50")
pvq_CON_sep = c("pvqsep13", "pvqsep26", "pvqsep53")
pvq_CON_fac = c("pvqfac09", "pvqfac24", "pvqfac49")
pvq_SEN_por = c("pvqpor12", "pvqpor20", "pvqpor44")
pvq_SEN_pod = c("pvqpod06", "pvqpod29", "pvqpod41")
pvq_SEN_ach = c("pvqach17", "pvqach32", "pvqach48")
pvq_SEN_he = c("pvqhed03", "pvqhed36", "pvqhed46")
pvq_OCH_st = c("pvqsti10","pvqsti28", "pvqsti43")
pvq_OCH_sda = c("pvqsda16", "pvqsda30", "pvqsda56")
pvq_OCH_sdt = c("pvqsd01", "pvqsdt23", "pvqsdt39")
# - list with pvq 12 (10 old and 2 new from 2014)
pvq_STR_ben = c("pvqbed19", "pvqbed27", "pvqbed55",
"pvqbec11", "pvqbec25", "pvqbec47")
pvq12_STR_un = c("pvqunt14", "pvqunt34", "pvqunt57",
"pvqunc05", "pvqunc37", "pvqunc52",
"pvqunc05", "pvqunc37", "pvqunc52")
pvq12_CON_hum = c("pvqhum07", "pvqhum38", "pvqhum54")
pvq12_CON_cov = c("pvqcoi04", "pvqcoi22", "pvqcoi51",
"pvqcor15", "pvqcor31", "pvqcor42")
pvq12_CON_trd = c("pvqtra18", "pvqtra33", "pvqtra40")
pvq12_CON_sec = c("pvqses02", "pvqses35", "pvqses50",
"pvqsep13", "pvqsep26", "pvqsep53")
pvq12_CON_fac = c("pvqfac09", "pvqfac24", "pvqfac49")
pvq12_SEN_pwr = c("pvqpor12", "pvqpor20", "pvqpor44",
"pvqpod06", "pvqpod29", "pvqpod41")
pvq12_SEN_ach = c("pvqach17", "pvqach32", "pvqach48")
pvq12_SEN_he = c("pvqhed03", "pvqhed36", "pvqhed46")
pvq12_OCH_st = c("pvqsti10","pvqsti28", "pvqsti43")
pvq12_OCH_sdr = c("pvqsda16", "pvqsda30", "pvqsda56",
"pvqsd01", "pvqsdt23", "pvqsdt39")
# - pvq hov
pvq_hov <- list(
pvq_STR = c("pvqbed19", "pvqbed27", "pvqbed55",
"pvqbec11", "pvqbec25", "pvqbec47",
"pvqunt14", "pvqunt34", "pvqunt57",
"pvqunc05", "pvqunc37", "pvqunc52",
"pvqunn08", "pvqunn21", "pvqunn45",
"pvqhum07", "pvqhum38", "pvqhum54"),
pvq_CON = c("pvqcoi04", "pvqcoi22", "pvqcoi51",
"pvqcor15", "pvqcor31", "pvqcor42",
"pvqtra18", "pvqtra33", "pvqtra40",
"pvqses02", "pvqses35", "pvqses50",
"pvqsep13", "pvqsep26", "pvqsep53",
"pvqfac09", "pvqfac24", "pvqfac49"),
pvq_SEN = c("pvqpor12", "pvqpor20", "pvqpor44",
"pvqpod06", "pvqpod29", "pvqpod41",
"pvqach17", "pvqach32", "pvqach48",
"pvqhed03", "pvqhed36", "pvqhed46"),
pvq_OCH = c("pvqsti10","pvqsti28", "pvqsti43",
"pvqsda16", "pvqsda30", "pvqsda56",
"pvqsd01", "pvqsdt23", "pvqsdt39")
)
# - list with pvq hov
pvq_STR = c("pvqbed19", "pvqbed27", "pvqbed55",
"pvqbec11", "pvqbec25", "pvqbec47",
"pvqunt14", "pvqunt34", "pvqunt57",
"pvqunc05", "pvqunc37", "pvqunc52",
"pvqunn08", "pvqunn21", "pvqunn45",
"pvqhum07", "pvqhum38", "pvqhum54")
pvq_CON = c("pvqcoi04", "pvqcoi22", "pvqcoi51",
"pvqcor15", "pvqcor31", "pvqcor42",
"pvqtra18", "pvqtra33", "pvqtra40",
"pvqses02", "pvqses35", "pvqses50",
"pvqsep13", "pvqsep26", "pvqsep53",
"pvqfac09", "pvqfac24", "pvqfac49")
pvq_SEN = c("pvqpor12", "pvqpor20", "pvqpor44",
"pvqpod06", "pvqpod29", "pvqpod41",
"pvqach17", "pvqach32", "pvqach48",
"pvqhed03", "pvqhed36", "pvqhed46")
pvq_OCH = c("pvqsti10","pvqsti28", "pvqsti43",
"pvqsda16", "pvqsda30", "pvqsda56",
"pvqsd01", "pvqsdt23", "pvqsdt39")
# - list
pvq_list <- list(names(pvq_dim))
pvq_hov_list <- list(names(pvq_hov))
pvq_12dim_list <- list(names(pvq_12dim))
# - list with valigo dimensions
valigo_dim <- list(
vlg_SEN_por = c("lgipow01", "lgipow02", "lgipow03"),
vlg_SEN_ach = c("lgiach01", "lgiach02", "lgiach03"),
vlg_SEN_he = c("lgihed01", "lgihed02", "lgihed03"),
vlg_OCH_st = c("lgisti01", "lgisti02", "lgisti03"),
vlg_OCH_sel = c("lgisel01", "lgisel02", "lgisel03"),
vlg_STR_uni = c("lgiuni01", "lgiuni02", "lgiuni03"),
vlg_STR_ben = c("lgiben01", "lgiben02", "lgiben03"),
vlg_CON_conf = c("lgicon01", "lgicon02", "lgicon03"),
vlg_CON_tr = c("lgitra01", "lgitra02", "lgitra03"),
vlg_CON_sec = c("lgisec01", "lgisec02", "lgisec03")
)
# - valigo dimensions
vlg_SEN_por = c("lgipow01", "lgipow02", "lgipow03")
vlg_SEN_ach = c("lgiach01", "lgiach02", "lgiach03")
vlg_SEN_he = c("lgihed01", "lgihed02", "lgihed03")
vlg_OCH_st = c("lgisti01", "lgisti02", "lgisti03")
vlg_OCH_sel = c("lgisel01", "lgisel02", "lgisel03")
vlg_STR_uni = c("lgiuni01", "lgiuni02", "lgiuni03")
vlg_STR_ben = c("lgiben01", "lgiben02", "lgiben03")
vlg_CON_conf = c("lgicon01", "lgicon02", "lgicon03")
vlg_CON_tr = c("lgitra01", "lgitra02", "lgitra03")
vlg_CON_sec = c("lgisec01", "lgisec02", "lgisec03")
# - list valigo hov
valigo_hov <- list(
valigo_SEN = c("lgipow01", "lgipow02", "lgipow03",
"lgiach01", "lgiach02", "lgiach03",
"lgihed01", "lgihed02", "lgihed03"),
valigo_OCH = c("lgisti01", "lgisti02", "lgisti03",
"lgisel01", "lgisel02", "lgisel03"),
valigo_STR = c("lgiuni01", "lgiuni02", "lgiuni03",
"lgiben01", "lgiben02", "lgiben03"),
valigo_CON = c("lgicon01", "lgicon02", "lgicon03",
"lgitra01", "lgitra02", "lgitra03",
"lgisec01", "lgisec02", "lgisec03")
)
# - valigo hov
valigo_SEN = c("lgipow01", "lgipow02", "lgipow03",
"lgiach01", "lgiach02", "lgiach03",
"lgihed01", "lgihed02", "lgihed03")
valigo_OCH = c("lgisti01", "lgisti02", "lgisti03",
"lgisel01", "lgisel02", "lgisel03")
valigo_STR = c("lgiuni01", "lgiuni02", "lgiuni03",
"lgiben01", "lgiben02", "lgiben03")
valigo_CON = c("lgicon01", "lgicon02", "lgicon03",
"lgitra01", "lgitra02", "lgitra03",
"lgisec01", "lgisec02", "lgisec03")
valigo_list <- list(names(valigo_dim))
valigo_hov_list <- list(names(valigo_hov))
# --- Cronbaach alpha
cronb_df <- tibble(
variable = vector("character",0),
alpha = vector("numeric",0),
ci_low = vector("numeric",0),
ci_high = vector("numeric",0)
)
## cronbach alpha table for loop ---
# - pvq dimensions
for (i in pvq_dim){
name = i
# name <- deparse(substitute(i))
tmp <- df %>%
dplyr::select(i) %>%
ltm::cronbach.alpha(.,na.rm=TRUE,CI=TRUE,B=100)
cronb_df <- cronb_df %>% add_row(
variable = name,
alpha = tmp$alpha,
ci_low = tmp$ci[1],
ci_high = tmp$ci[2]
)
rm(tmp)
cronb_df <- cronb_df %>% distinct(., alpha, .keep_all = T)
}
## rename indexe ---
cronb_df$indexe <- names(pvq_dim)
# - valigo dimensions
for (i in valigo_dim){
name = i
# name <- deparse(substitute(i))
tmp <- df %>%
dplyr::select(i) %>%
ltm::cronbach.alpha(.,na.rm=TRUE,CI=TRUE,B=100)
cronb_df <- cronb_df %>% add_row(
variable = name,
alpha = tmp$alpha,
ci_low = tmp$ci[1],
ci_high = tmp$ci[2]
)
rm(tmp)
cronb_df <- cronb_df %>% distinct(., alpha, .keep_all = T)
}
cronb_df[20:29,]$indexe <- names(valigo_dim)
# - pvq hov
for (i in pvq_hov){
name = i
# name <- deparse(substitute(i))
tmp <- df %>%
dplyr::select(i) %>%
ltm::cronbach.alpha(.,na.rm=TRUE,CI=TRUE,B=100)
cronb_df <- cronb_df %>% add_row(
variable = name,
alpha = tmp$alpha,
ci_low = tmp$ci[1],
ci_high = tmp$ci[2]
)
rm(tmp)
cronb_df <- cronb_df %>% distinct(., alpha, .keep_all = T)
}
cronb_df[30:33,]$indexe <- names(pvq_hov)
# - valigo hov
for (i in valigo_hov){
name = i
# name <- deparse(substitute(i))
tmp <- df %>%
dplyr::select(i) %>%
ltm::cronbach.alpha(.,na.rm=TRUE,CI=TRUE,B=100)
cronb_df <- cronb_df %>% add_row(
variable = name,
alpha = tmp$alpha,
ci_low = tmp$ci[1],
ci_high = tmp$ci[2]
)
rm(tmp)
cronb_df <- cronb_df %>% distinct(., alpha, .keep_all = T)
}
cronb_df[34:37,]$indexe <- names(valigo_hov)
cronb_df <- cronb_df %>%relocate(indexe, .before=alpha) %>% subset(.,select=-variable) %>% round_df()
# - cronbach alpha for Schwartz 12 dimensions
cronb_tmp <- tibble(
variable = vector("character",0),
alpha = vector("numeric",0),
ci_low = vector("numeric",0),
ci_high = vector("numeric",0)
)
for (i in pvq_12dim){
name = i
# name <- deparse(substitute(i))
tmp <- df %>%
dplyr::select(i) %>%
ltm::cronbach.alpha(.,na.rm=TRUE,CI=TRUE,B=100)
cronb_tmp  <- cronb_tmp  %>% add_row(
variable = name,
alpha = tmp$alpha,
ci_low = tmp$ci[1],
ci_high = tmp$ci[2]
)
rm(tmp)
cronb_tmp  <- cronb_tmp  %>% distinct(., alpha, .keep_all = T)
}
cronb_tmp$indexe <- names(pvq_12dim)
cronb_tmp <- cronb_tmp %>%relocate(indexe, .before=alpha) %>% subset(.,select=-variable) %>% round_df()
# - joins cronbach alpha tables
cronbach <- full_join(cronb_df, cronb_tmp)
# --- Ipsatization and then Scale construction
names_pvq <- df %>% select(starts_with("pvq")) %>% names()
names_valigo <- df %>% select(starts_with("lgi")) %>% select(-lgioq01,-lgioq02) %>%  names()
df_ipst <- df
df_ipst$pvq_mean <- rowMeans(df_ipst[names_pvq], na.rm = FALSE)
df_ipst$valigo_mean <- rowMeans(df_ipst[names_valigo], na.rm = FALSE)
df_ipst <- df_ipst %>% rowwise() %>%
mutate(across(all_of(names_pvq), ~.x - pvq_mean),
across(all_of(names_valigo), ~.x - valigo_mean)) %>%
ungroup() %>%
scale_builder(., pvq_dim, score_fun = "mean") %>%
scale_builder(., pvq_12dim, score_fun = "mean") %>%
scale_builder(., valigo_dim, score_fun = "mean") %>%
scale_builder(., pvq_hov, score_fun = "mean") %>%
scale_builder(., valigo_hov, score_fun = "mean") %>%
select(-one_of(valigo_SEN),-one_of(valigo_STR),
-one_of(valigo_CON),-one_of(valigo_OCH),
-one_of(pvq_SEN),-one_of(pvq_STR),
-one_of(pvq_CON),-one_of(pvq_OCH))
# --- cleans data
df_ipst <- df_ipst %>%
sjlabelled::set_na(krybsz01,na=0) %>%
mutate_at(vars("kryftl07"), flip_item)
## --- save data
save(list=c("df", "df_ipst",
"df_labels","cronbach",
"pvq_dim","pvq_hov",
"valigo_dim","valigo_hov"),
file="data/df.Rdata")
# --- Descriptive stats
# --- packages import
if (!require(rstatix)) {
install.packages("rstatix")
require(rstatix)
}
if (!require(Hmisc)) {
install.packages("Hmisc")
require(Hmisc)
}
if (!require(corrplot)) {
install.packages("corrplot")
require(corrplot)
}
if (!require(psych)) {
install.packages("psych")
require(psych)
}
library(rstatix)
library(Hmisc)
library(corrplot)
library(psych)
# --- data import
load("data/df.Rdata")
# --- extra functions
source("scripts/helper_functions.R")
# --- sample and item descriptions
# - categorial variables
# employment = employ
# sex = sex
# education = edu
sample<-df_ipst %>%
dplyr::select(sex,edu,employ) %>%
naturalize_labelled_df() %>%
pivot_longer(cols=c(sex_fct,
edu_fct,
employ_fct)) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate( total_n=sum(n),
prop=100*n/sum(n),
cum=100*cumsum(prop/sum(prop))) %>%
ungroup()
# --- Descriptive stats
# --- packages import
if (!require(rstatix)) {
install.packages("rstatix")
require(rstatix)
}
if (!require(Hmisc)) {
install.packages("Hmisc")
require(Hmisc)
}
if (!require(corrplot)) {
install.packages("corrplot")
require(corrplot)
}
if (!require(psych)) {
install.packages("psych")
require(psych)
}
library(rstatix)
library(Hmisc)
library(corrplot)
library(psych)
# --- data import
load("data/df.Rdata")
# --- extra functions
source("scripts/helper_functions.R")
# --- sample and item descriptions
# - categorial variables
# employment = employ
# sex = sex
# education = edu
sample<-df_ipst %>%
dplyr::select(sex,edu,employ) %>%
naturalize_labelled_df() %>%
pivot_longer(cols=c(sex_fct,
edu_fct,
employ_fct)) %>%
group_by(name,value) %>%
summarise(n=n()) %>%
mutate( total_n=sum(n),
prop=100*n/sum(n),
cum=100*cumsum(prop/sum(prop))) %>%
ungroup()
# - ordinal variables
# --- Correlations
corr_df <- df_ipst %>%
filter(krybws01==1) %>%
dplyr::select(age,
starts_with("pvq"),starts_with("valigo"),
starts_with("kry"))
correlations <- corr_df %>%
select(-kryerw11tb,-krykew10tb,-pvq_mean,-valigo_mean) %>%
cor_test(everything(),
use="pairwise.complete.obs") %>%
subset(.,select=c(-statistic,-method))
# - sub-table with select correlations
# - pvq dimensions and hov with everything else
correlations_pvq <- correlations %>%
filter(grepl("pvq",var1))
# - valigo dimensions and hov with everything else
correlations_valigo <- correlations %>%
filter(grepl("valigo",var1))
# --- correlations in a different form
corr_v2 <- df_ipst %>%
filter(krybws01==1) %>%
dplyr::select(age,
ends_with("_SEN"),
ends_with("_STR"),
ends_with("_CON"),
ends_with("_OCH"),
starts_with("kryftl"),
kryvst01,
starts_with("krymng"))
mydata.rcorr <- rcorr(as.matrix(corr_v2))
#mydata.rcorr
mydata.cor <- cor(corr_v2, method="spearman")
corrplot(mydata.cor)
heatmap(mydata.cor,symm=TRUE)
# --- correlations in a 3rd form
corr_v3 <- df_ipst %>%
cor_test(vars = (starts_with("pvq") & !ends_with("_mean") ),
vars2 = c(age,
starts_with("kryftl"),
kryvst01,
starts_with("krymng")),
use="pariwise.complete.obs") %>%
subset(.,select=c(-statistic,
-method ) )
# --- correlations Schwart 12
corr_v4 <- df_ipst %>%
cor_test(vars = (starts_with("pvq12") & !ends_with("_mean") ),
vars2 = c(age,
starts_with("kryftl"),
kryvst01,
starts_with("krymng")),
use="pariwise.complete.obs") %>%
subset(.,select=c(-statistic,
-method ) )
# --- save data
save(list=c("sample", "corr_df", "correlations",
"corr_v3", "corr_v4","mydata.rcorr"),
file="data/descriptives.Rdata")
sample
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
r <- getOption("repos")
r["CRAN"] <-"https://cloud.r-project.org/"
options(repos=r)
## these are packages needed for these analyses
if (!require(tidyverse)) {
install.packages("tidyverse")
require(tidyverse)
}
if (!require(dplyr)) {
install.packages("dplyr")
require(dplyr)
}
if (!require(knitr)) {
install.packages("knitr")
require(knitr)
}
if (!require(wesanderson)) {
install.packages("wesanderson")
require(wesanderson)
}
if (!require(haven)) {
install.packages("haven")
require(haven)
}
if (!require(kableExtra)) {
install.packages("kableExtra")
require(kableExtra)
}
if (!require(DT)) {
install.packages("DT")
require(DT)
}
if (!require(Hmisc)) {
install.packages("Hmisc")
require(Hmisc)
}
if (!require(corrplot)) {
install.packages("corrplot")
require(corrplot)
}
# load packages
library("tidyverse")
library("dplyr")
library("knitr")
library("wesanderson")
library("haven")
library("kableExtra")
library("DT")
library("Hmisc")
library("corrplot")
# --- imports data
load("data/df.Rdata")
load("data/descriptives.Rdata")
load("data/pca.Rdata")
# --- imports source scripts
source("scripts/helper_functions.R")
# --- theme for plots
mytheme <- theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=1, size = 10),
panel.background = element_rect(fill="white", color = "grey50"),
panel.grid.major.y = element_line(color="grey90"),
axis.title.y = element_text(vjust= 0.5, hjust=1, angle = 90) )
sample
sample[18,4]
sample[18,5]
df_ipst$age
summary(df_ipst$age)
sd(df_ipst$age)
mean(df_ipst$age)
_M_{age}
a<-summary(df_ipst$age)
a[1]
age.min = as.numeric(summary(df_ipst$age)[1])
age.min
